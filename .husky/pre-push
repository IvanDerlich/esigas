echo "Checking code formatting..."

# Run prettier in check mode
npm run format:check
if [ $? -ne 0 ]; then
  echo "Push rejected: code is not properly formatted."
  echo "Please run 'npm run format' to fix formatting issues."
  exit 1
fi

echo "Formatting OK. Running build before push..."

# Run build and handle failure manually
npm run build
if [ $? -ne 0 ]; then
  echo "Push rejected: build failed. Please fix build errors before pushing."
  exit 1
fi

echo "Build succeeded. Proceeding with push..."